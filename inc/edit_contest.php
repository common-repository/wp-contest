<?php /*  * 	@PACKAGE WP CONTEST*	USE: Save Contest Settings*/if(!function_exists('wpc_save_single_contest')){	function wpc_save_single_contest(){		global $wpdb;		$table_name = $wpdb->prefix . 'wpc_contests';				if(!current_user_can('manage_options')){			wp_die('You are not allowed to edit this page.');		}		check_admin_referer('wpc_save_single_contest_verify');	// var_dump($_POST);	// die();		$contest_id = absint( sanitize_text_field( $_POST['contest_id'] ) );		$contest_on_off = $_POST['contest_on_off'];		$max_num_files = $_POST['max_num_files'];		$file_types = $_POST['file_types'];		$upload_cost = $_POST['upload_cost'];		$maximum_entry = $_POST['maximum_entry'];		$title_label = $_POST['title_label'];		$category_label = $_POST['category_label'];		$category_options = $_POST['category_options'];		$description_label = $_POST['description_label'];		$upload_label = $_POST['upload_label'];		$upload_type = $_POST['upload_type'];		$tos_page_id = $_POST['tos_page_id'];		$current_phase = $_POST['current_phase'];		$who_can_upload = $_POST['who_can_upload'];		$phsae_one_vote = $_POST['phsae_one_vote'];		$phase_one_oparetor = $_POST['phase_one_oparetor'];		$phase_one_vote_count = $_POST['phase_one_vote_count'];		$contest_type = $_POST['contest_type'];		if(count(wpc_number_of_active_contest()) > 0 ){			if(wpc_number_of_active_contest()[0] != $contest_id ){				$contest_on_off = 'off';			}		}				$fields = array(			'contest_on_off' => sanitize_text_field($contest_on_off),			'max_num_files' => sanitize_text_field($max_num_files),			'file_types' => sanitize_text_field('jpg,pdf'),			'upload_cost' => sanitize_text_field($upload_cost),			'maximum_entry' => 50,			'title_label' => sanitize_text_field($title_label),						'category_label' => sanitize_text_field($category_label),			'category_options' => explode(",", sanitize_text_field($category_options)), 			'description_label' => sanitize_text_field($description_label),						'upload_label' => sanitize_text_field($upload_label),			'upload_type'=> sanitize_text_field($upload_type),						'tos_page_id' => sanitize_text_field($tos_page_id),			'current_phase' => 2,			'who_can_upload' => sanitize_text_field($who_can_upload),			'phsae_one_vote' => sanitize_text_field($phsae_one_vote),			'phase_one_oparetor' => sanitize_text_field($phase_one_oparetor),			'phase_one_vote_count' => sanitize_text_field($phase_one_vote_count),			'contest_type' => sanitize_text_field('free'),					);				$fields = serialize($fields);		$title = sanitize_text_field($_POST['title']);		$update = $wpdb->update( 			$table_name, 			array( 				'title' => $title,	// string				'fields' => $fields	// integer (number) 			), 			array( 'id' => $contest_id ), 			array( 				'%s',					'%s'				), 			array( '%d' ) 		);				wp_redirect( esc_url_raw( get_admin_url().'admin.php?page=wpc_contests&contest_id='.absint($contest_id).'&status=1' ) );		exit();					}}