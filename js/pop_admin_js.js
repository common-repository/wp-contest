/*  * 	@PACKAGE WP CONTEST*	USE: admin pages ui*/jQuery(document).ready(function($){function doConfirmContest(msg, yesFn, noFn) {		var confirmBox = $("#confirmBox");		confirmBox.find(".message").text(msg);		confirmBox.find(".yes,.no").unbind().click(function () {			confirmBox.hide();		});		confirmBox.find(".yes").click(yesFn);		confirmBox.find(".no").click(noFn);		confirmBox.show();		}function uniqID(idlength) {            	 this.length = 8;		 this.timestamp = +new Date;		 		 var _getRandomInt = function( min, max ) {			return Math.floor( Math.random() * ( max - min + 1 ) ) + min;		 }		 		 			 var ts = this.timestamp.toString();			 var parts = ts.split( "" ).reverse();			 var id = "";			 			 for( var i = 0; i < this.length; ++i ) {				var index = _getRandomInt( 0, parts.length - 1 );				id += parts[index];	 			 }			 			 return id;       }//Sorting Function 	function getSorted(selector, attrName) {			return $($(selector).toArray().sort(function(a, b){				var aVal = parseInt(a.getAttribute(attrName)),					bVal = parseInt(b.getAttribute(attrName));				return aVal - bVal;			}));	}	function getSortedDesc(selector, attrName) {			return $($(selector).toArray().sort(function(a, b){				var aVal = parseInt(a.getAttribute(attrName)),					bVal = parseInt(b.getAttribute(attrName));				return bVal  - aVal;			}));	}		// judge dashborad order	$(document.body).on('change', '.pop_filter_order', function(){	 var order_value = $(this).val();		if(order_value == 'asc'){			$('.equalHMVWrap.eqWrap').html(getSorted('.equalHMV.eq', 'entry_id'));					}				if(order_value == 'desc'){			$('.equalHMVWrap.eqWrap').html(getSortedDesc('.equalHMV.eq', 'entry_id'));					}				if(order_value == 'score_desc'){			$('.equalHMVWrap.eqWrap').html(getSortedDesc('.equalHMV.eq', 'score'));					}				if(order_value == 'score_asc'){			//console.log(getSorted('tr.pop_dash_view_entry ', 'score'));			$('.equalHMVWrap.eqWrap').html(getSorted('.equalHMV.eq', 'score'));								}								});		/*	* filter phase two show winner only	*/	$(document.body).on('click', '.filter_show_winner', function(){		var that = $(this);		var target = $('.equalHMV.eq.single_entry');		if(that.is(":checked")) {			$(target).each(function(){			if(!$(this).hasClass('pop_winner')){ $(this).addClass('pop_hidden');  }						});			} else {				$(target).each(function(){			$(this).removeClass('pop_hidden');						});;							}		});	//remove crireria	$(document.body).on('click', '#remove_criteria', function(){		var criteria_id = $(this).attr('criteria_id');		var target = $('tr[criteria_id="'+criteria_id+'"]');		target.fadeOut(300, function(){ target.remove(); });			});	// add criteria	$(document.body).on('click', '.add_criteria', function(){				var generateId = uniqID();		var html = criterisObj.voting_template;				var html = html.replace(/__UNIQID__/gi, generateId);				$("table.phasetwovoting").append(html);					});			/*	* DELETE CONTEST	*/	var deleteContestAjaxFunction = function(fromdata, action){		$.ajax({			type:'post',			url: criterisObj.ajaxurl,			data:{				action:action,				data:fromdata,				security:criterisObj.security,															},			success:function(response){				//$('div.msg').html(reponse);				console.log(response);				if(response == 'success'){					location.reload();					}			},			error:function(response){				alert(response);			}								});							}	$(document.body).on('click', '.delet_contest', function(){		var that = $(this);	var contest_id = that.attr('contest_id');	doConfirmContest("Are you sure you want to delete this contest?", function yes() {			console.log(contest_id);			var fromdata = {			'contest_id':contest_id,												};				deleteContestAjaxFunction(fromdata, 'wpc_delete_contest');				}, function no() {				console.log('no confirm');			});		});							/*	* DELETE CONTEST	*/	var markAsWinnerAjaxFunction = function(fromdata, action){		$.ajax({			type:'post',			url: criterisObj.ajaxurl,			data:{				action:action,				data:fromdata,				security:criterisObj.security,															},			success:function(response){				//$('div.msg').html(reponse);				console.log(response);							},			error:function(response){				alert(response);			}								});							}		$(document.body).on('click', '.pop_mark_as_winner', function(){		var __that = $(this);		var contest_id = __that.attr('contest_id');		var entry_id = __that.attr('value');		if(__that.is(":checked")) {			var fromdata = {			'contest_id':contest_id,			'entry_id':entry_id,			'action': 'add'												};			markAsWinnerAjaxFunction(fromdata, 'wpc_mark_as_winner');			$('.single_entry.equalHMV.eq').addClass('pop_winner');			} else {					var fromdata = {				'contest_id':contest_id,				'entry_id':entry_id,				'action': 'remove'																};				markAsWinnerAjaxFunction(fromdata, 'wpc_mark_as_winner');				$('.single_entry.equalHMV.eq').removeClass('pop_winner');			}				});				//hide Out of contest entry in phase One		$(document.body).on('click', '#hide_out_contest', function(){		  if($(this).is(':checked')){			  $('.phase_one_photos .phase_one_single_photo.out').addClass('pop_hidden');		  }else{			  $('.phase_one_photos .phase_one_single_photo.out').removeClass('pop_hidden');		  }		});		/*		* Notify Winner mail		*/		var notifyWinnerMail = function(fromdata, action){		$.ajax({			type:'post',			url: criterisObj.ajaxurl,			data:{				action:action,				data:fromdata,				security:criterisObj.security,															},			success:function(response){				$('.pop_winner_notification_form .sending_mail').css('display', 'none');				$('p.pop_winner_notification_result').html(response);				$("form.pop_winner_notification_form")[0].reset();							},			error:function(response){				alert(response);			}								});							}								$(document.body).on('submit', 'form.pop_winner_notification_form', function(event){			  event.preventDefault();				var messagedata = {				'subject': $('#winner_notification_subject').val(),				'message':$('#winner_notification_message').val(),				'contest_id':$('#notification_contest_id').val()																				};			$('.pop_winner_notification_form .sending_mail').css('display', 'block');			notifyWinnerMail(messagedata, 'wpc_notify_winners');		});		$('[data-toggle="tooltip"]').tooltip(); });