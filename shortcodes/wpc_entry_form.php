<?php /*  * 	@PACKAGE WP CONTEST*	USE: Shortcode for entry form*/if(!function_exists('wpc_contests_enrtry_form')){function wpc_contests_enrtry_form($atts, $content = null){	extract(shortcode_atts(array(			'contest_id'=>'0',				),$atts,'wpc_entry_form'));		$contest_id = sanitize_text_field( $contest_id );	if(!is_user_logged_in()){		return 'only loggedin user can upload photos.';	}	if($contest_id != '0'){	$all_contest_id = wpc_get_all_contest_id();	if(!$all_contest_id){		return 'No Contest Found';	}	if(!count($all_contest_id)){		return 'No Contest Found';	}			if(!in_array( $contest_id, $all_contest_id)){		 return 'No Contest Found';	}			$total_num_entry = wpc_contest_count_number_of_entry($contest_id);	$WPC_contest_settings = new WPC_contest_settings($contest_id);	$settings = $WPC_contest_settings->WPC_the_contest_settings();	$category_options = $settings['category_options'];	if(count($category_options)){		$cat_opt = '';		foreach($category_options as $opt){			$cat_opt .= '<option value="'.$opt.'">'.$opt.'</option>';		}	}else{		$cat_opt = '';	}		if($settings['contest_on_off'] == 'off'){		return 'We Are Not accepting a photos for this Contest.';	}		if($settings['who_can_upload'] == 'wpc_contestant' && !in_array( 'wpc_contestant',  wp_get_current_user()->roles) ){		return 'Only contestant Can Upload Photos for this Contest.';	}		if($total_num_entry >= $settings['maximum_entry']){		return 'We Are Not accepting a photos. Contest Reached Its Maximum Upload.';	}		$form = '<h1 class="contest_title">'.wpc_get_contest_title($contest_id).'</h1><div  class="vali_msg"></div><form id="pop_entry_form" enctype="multipart/form-data" action="" method="post">								<table class="pop_entry_table" >								<tr class="single_upload">										<td class="title_wrap" >						<div class="validatin_msg"></div>						<label for="title">'.$settings['title_label'].':</label>						<input class="pc_entry_form_title" id="title" name="title[]" type="text" />					</td>															<td  class="category_wrap" >						<label for="category">'.$settings['category_label'].':</label>						<select class="pc_entry_form_category" name="category[]" id="category">							'.$cat_opt.'						</select>					</td>					<td   class="description_wrap" >						<label for="description">'.$settings['description_label'].':</label>						<textarea class="pc_entry_form_description" name="description[]" id="description" cols="30" rows="10"></textarea>					</td>					<td   class="upload_wrap" ><label>Entry</label><label for="" class="upload-label">'.$settings['upload_label'].'</label> ';									$form .= 			'<input name="pop_images[]" type="file"  />								</td>				</tr>				<tr class="single_upload_addtional_fields">						<td colspan="4">'.wpc_front_end_addtion_fields_markup($contest_id).'</td>				</tr>				</table>				<style type="text/css"> td, th{ display:block; padding:0; }</style>				<input value="'.$contest_id.'" type="hidden" name="contest_id"/>				<div class="upload_another_wrap">					<span class="upload_another">+ Add Entry</span> <span class="another_upload_text"></span>				</div>				<div class="tos">					<input name="tos" type="checkbox" />I have read and agree to the <a target="_blank" href="'.get_the_permalink($settings['tos_page_id']).'">Terms & Conditions</a>				</div>';				ob_start();				wp_nonce_field( 'wpc_up_load_entry_action', 'wpc_up_load_entry_field' );				$form .= ob_get_clean();			$form .=	'<input name="pop_submit" type="submit" />						 			 </form>';			 if( isset( $_POST['pop_submit'] ) ){			  			 			 			 $WPC_Validation = new WPC_Validation();			 $popfilevalidation = $WPC_Validation->wpc_upload_validation($_FILES['pop_images']);						if(!$popfilevalidation){				$form =  $WPC_Validation->error().$form;							}			if(isset($_POST['insert_upload_msg'])){								$form =  $_POST['insert_upload_msg'].$form;			}						}			return $form;	}}}