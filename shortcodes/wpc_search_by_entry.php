<?php /*  * 	@PACKAGE WP CONTEST*	USE: Search entry shortcode*/if(!function_exists('wpc_search_by_entry')){function wpc_search_by_entry(){		$output ='';	$search_again = '<a href="'.get_the_permalink().'">Search Again</a>';	if(isset($_GET['entry_id'])){		$entry_id = sanitize_text_field($_GET['entry_id']);		$entry_values = wpc_get_entry_if_paid($entry_id);				if(!$entry_values){			return 'No entry found with this entry number '.$search_again.'.';		}						$entry_meta = unserialize( $entry_values['entry_meta'] );		$img_src = wpc_upload_dir_url().$entry_meta['image'];		//Pop_download_entry($entry_id);		$output .='		<div class="entry_search_result_wrap">			<div class="search_result_img_wrap">				<img class="searched_img" src="'. esc_url_raw( $img_src ).'" alt="" />			</div>			<div class="earched_img_info_box_wrap">				<h1><b>Contest Title:</b> '.wpc_get_contest_title($entry_values['contest_id']).'</h1>				<h1><b>Entry Number:</b> '.$entry_values['id'].'</h1>				<h1><b>Title:</b> '.$entry_meta['title'].'</h1>				<h1><b>Category:</b> '.$entry_meta['category'].'</h1>				<h1><b>Description:</b> </h1><p class="_des">'.$entry_meta['description'].'</p>				<h1><b>Submitted By:</b> '.get_user_by('id', $entry_values['user_id'])->display_name.'</h1>				<h1><b>Submitted On:</b> '.$entry_values['entry_time'].'</h1>			</div>			<form method="post" class="pop_pdf_download_form">				<input type="hidden" value="'.$entry_id.'"  name="get_entry_id" />				<input value="Download" type="submit" name="download_entry"/>			</form>		</div>		<div class="text-center">'.$search_again.'</div>		';					}elseif(isset($_GET['contest_id']) && isset($_GET['contesttant']) && isset($_GET['pop_categories']) ){		$output .= wpc_advance_search();			}else{		$contestants = wpc_get_contestants_in_options();		$contests = wpc_get_contests_options();		$categories = wpc_get_all_contest_all_categories();		if($contestants){			$contestants = '<select name="contesttant" id="contesttant_dropdown">'.$contestants.'</select>';		}else{			$contestants = '&nbsp;';		}		$contests  = $contests ? $contests : '&nbsp;';		$categories = $categories ? $categories : '&nbsp;';		$output .= '<div class="pc_search_by_entry_form_wrap">					<div class="phpSearchBy">						<input name="popsearchformtype"  id="popsearchformtype" checked value="formOne" type="radio" /> Search By Entry Number						<input name="popsearchformtype" id="popsearchformtype" value="formTwo"  type="radio" /> Advance Search					</div>					<div class="formOne"><h1 class="pc_search_by_entry_form_title"> Search Entry By Number</h1>					<form  class="pc_search_by_entry_form" method="GET" action="">						Entry Id : 						<input id="entry_id" name="entry_id"  type="number" />												<input id="entry_id_submit" type="submit" value="Search Entries" />																	</form></div>';			$output .=	'<div class="formTwo"><h1 class="pc_search_by_category"> Search Entry By Category & Contestant</h1>					<form  class="pc_search_by_entry_form" method="GET" action="">						<table style="width:100%">						  <tr>							<th>Contest</th>							<td>								'.$contests.'							</td>						  </tr>						  <tr>							<th>Contestant</th> 							<td>								'.$contestants.'							</td>						  </tr>						  <tr>							<th>Category</th> 							<td>								'.$categories.'							</td>						  </tr>						  <tr>							<td colspan="2">								<input name="contest_id_submit" id="contest_id_submit" type="submit" value="Search" />							</td>						  </tr>						</table> 																								</form></div>';								$output .=		'</div>';	}	return $output;}}if(!function_exists('wpc_down_the_pdf')){function wpc_down_the_pdf(){if(isset($_POST['download_entry'])){			require(WPC_PATH.'/inc/pdf_download.php');			$entry_id = absint( sanitize_text_field( $_POST['get_entry_id'] ) );			wpc_download_entry($entry_id);			}}}if(!function_exists('wpc_download_pdf_file')){function wpc_download_pdf_file(){if(isset($_POST['download_entry'])){	$entry_id = absint($_POST['get_entry_id']);	?>	<script type="text/javascript">	 var handle = false;    function Download() {        if(handle)return;        handle=true;		window.location = "<?php echo rtrim(get_site_url(), '/'); ?>/wp-content/uploads/pop_pdf/pop_<?php echo $entry_id;  ?>.pdf";    }     Download();		</script>	<?php}}}